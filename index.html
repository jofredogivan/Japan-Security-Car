<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Security Car - Controle de Frotas</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="theme-color" content="#FF0000"/>
    <link rel="manifest" href="manifest.json">
</head>
<body>

    <header>
        <h1>Japan Security Car üöó</h1>
    </header>

    <main class="container">
        
        <section id="dashboard" class="page">
            <h2>Dashboard</h2>
            <div id="movimentacoes-list" class="list-container">
                <div class="card card-placeholder">Carregando informa√ß√µes das viaturas...</div>
            </div>
        </section>

        <section id="cadastro-veiculo" class="page hidden">
            <h2>Cadastro de Viatura</h2>
            
            <form id="form-cadastro-veiculo">
                <div class="form-group">
                    <label for="veiculo-placa">Placa (Ex: AAA-1234):</label>
                    <input type="text" id="veiculo-placa" placeholder="Placa do ve√≠culo" required maxlength="8">
                </div>
                
                <div class="form-group">
                    <label for="veiculo-modelo">Modelo/Descri√ß√£o:</label>
                    <input type="text" id="veiculo-modelo" placeholder="Ex: FIAT UNO" required>
                </div>
                
                <div class="form-group">
                    <label for="veiculo-km">KM Inicial/Atual:</label>
                    <input type="number" id="veiculo-km" placeholder="Quilometragem" required min="1">
                </div>
                
                <button type="submit" class="btn btn-primary">Cadastrar Viatura</button>
            </form>

            <h3 style="margin-top: 30px;">Viatura Cadastradas (Clique no bot√£o para EXCLUIR)</h3>
            <div id="veiculos-list-cadastro" class="list-container">
                <div id="movimentacoes-list"></div>
            </div>
        </section>

        <section id="movimentacao" class="page hidden">
            <h2>Registro de Movimenta√ß√£o</h2>
            <form id="form-movimentacao">
                
                <div class="form-group">
                    <label for="mov-placa">Viatura:</label>
                    <select id="mov-placa" required>
                        <option value="">-- Selecione a Viatura --</option>
                        </select>
                </div>
                
                <div class="form-group">
                    <label for="mov-motorista">Motorista/Respons√°vel:</label>
                    <input type="text" id="mov-motorista" placeholder="Nome completo" required>
                </div>
                
                <div class="form-group">
                    <label for="mov-tipo">Tipo de Movimenta√ß√£o:</label>
                    <select id="mov-tipo" required>
                        <option value="saida">Sa√≠da</option>
                        <option value="entrada">Entrada</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="mov-data-hora">Data e Hora:</label>
                    <input type="datetime-local" id="mov-data-hora" required>
                </div>
                
                <div class="form-group">
                    <label for="mov-km-atual">KM Atual (Obrigat√≥rio na Entrada):</label>
                    <input type="number" id="mov-km-atual" placeholder="Preenchido automaticamente ao selecionar a placa" min="0">
                </div>
                
                <h3>Checklist</h3>
                <div id="mov-checklist" class="checklist-group">
                    <input type="checkbox" id="check-pneus" value="Pneus"> <label for="check-pneus">Pneus (Calibragem/Avarias)</label><br>
                    <input type="checkbox" id="check-oleo" value="√ìleo/√Ågua"> <label for="check-oleo">N√≠vel √ìleo/√Ågua</label><br>
                    <input type="checkbox" id="check-documentos" value="Documentos"> <label for="check-documentos">Documentos do ve√≠culo</label><br>
                    <input type="checkbox" id="check-limpeza" value="Limpeza"> <label for="check-limpeza">Limpeza interna/externa</label><br>
                    <input type="checkbox" id="check-combustivel" value="Combust√≠vel"> <label for="check-combustivel">Combust√≠vel</label><br>
                </div>

                <div class="form-group">
                    <label for="mov-observacao">Observa√ß√£o:</label>
                    <textarea id="mov-observacao" placeholder="Condi√ß√£o geral, ocorr√™ncias..."></textarea>
                </div>
                
                <h3>Assinatura do Motorista/Respons√°vel</h3>
                <div class="signature-pad-container">
                    <canvas id="signature-pad" width="300" height="150" style="border: 1px solid #ccc; background-color: white;"></canvas>
                    <button type="button" id="clear-signature" class="btn btn-secondary" style="margin-top: 5px;">Limpar Assinatura</button>
                </div>

                <button type="submit" class="btn btn-primary" style="margin-top: 15px;">Registrar Movimenta√ß√£o</button>
            </form>
        </section>

        <section id="atualizacao-km" class="page hidden">
            <h2>Atualiza√ß√£o de Quilometragem</h2>
            <p>Use esta tela para registrar o KM atual das viaturas durante a vistoria noturna.</p>
            
            <form id="form-atualizacao-km">
                <div class="form-group">
                    <label for="update-placa">Selecione a Viatura:</label>
                    <select id="update-placa" required>
                        <option value="">-- Selecione --</option>
                        </select>
                </div>
                
                <div class="form-group" id="km-info-display" style="margin-top: 15px;">
                    </div>
                
                <div class="form-group">
                    <label for="update-km-novo">Novo KM Atual:</label>
                    <input type="number" id="update-km-novo" placeholder="KM registrado na vistoria" required min="1">
                </div>
                
                <button type="submit" class="btn btn-primary">
                    Registrar Novo KM
                </button>
            </form>
        </section>

        <section id="historico" class="page hidden">
            <h2>Hist√≥rico e Auditoria</h2>
            
            <div class="filter-group">
                <div class="form-group">
                    <label for="filtro-veiculo">Filtrar por Viatura:</label>
                    <select id="filtro-veiculo">
                        <option value="">Todas</option>
                        </select>
                </div>
                <div class="form-group">
                    <label for="filtro-data-inicio">Data Inicial:</label>
                    <input type="date" id="filtro-data-inicio">
                </div>
                <div class="form-group">
                    <label for="filtro-data-fim">Data Final:</label>
                    <input type="date" id="filtro-data-fim">
                </div>
                
                <button id="btn-buscar-auditoria" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Buscar Hist√≥rico</button>
                
                <div class="download-buttons">
                    <button id="btn-download-pdf" class="btn btn-secondary">Download PDF</button>
                    <button id="btn-download-excel" class="btn btn-secondary">Download Excel</button>
                </div>
            </div>

            <div class="filter-group" style="margin-top: 20px;">
                <h3>Consulta R√°pida de KM</h3>
                <div class="form-group">
                    <label for="select-veiculos-km">Viatura:</label>
                    <select id="select-veiculos-km">
                        <option value="">-- Selecione --</option>
                        </select>
                </div>
                <div id="veiculo-km-info" style="margin-top: 10px; font-size: 14px;">
                    </div>
            </div>

            <h3 style="margin-top: 30px;">Resultados da Auditoria</h3>
            <div id="resultados-auditoria" class="list-container">
                <div class="card card-placeholder">Fa√ßa uma busca para carregar o hist√≥rico de movimenta√ß√µes.</div>
            </div>
        </section>

    </main>

    <div id="fab-action" class="fab">
        <i class="fas fa-plus"></i>
    </div>

    <nav class="nav-bar">
        <button class="nav-btn active" data-target="dashboard">
            <i class="fas fa-home"></i>
            Dashboard
        </button>
        <button class="nav-btn" data-target="cadastro-veiculo">
            <i class="fas fa-car-side"></i>
            Cadastro Viatura
        </button>
        <button class="nav-btn" data-target="movimentacao">
            <i class="fas fa-exchange-alt"></i>
            Movimenta√ß√£o
        </button>
        <button class="nav-btn" data-target="atualizacao-km">
            <i class="fas fa-tachometer-alt"></i>
            KM Vistoria
        </button>
        <button class="nav-btn" data-target="historico">
            <i class="fas fa-history"></i>
            Hist√≥rico
        </button>
    </nav>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script type="module" src="db.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>
